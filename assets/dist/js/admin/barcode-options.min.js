"use strict";

function _typeof(e) {
    return (_typeof = "function" == typeof Symbol && "symbol" == typeof Symbol.iterator ? function(e) {
        return typeof e
    } : function(e) {
        return e && "function" == typeof Symbol && e.constructor === Symbol && e !== Symbol.prototype ? "symbol" : typeof e
    })(e)
}
jQuery(document).ready(function(v) {
    var i = {
        init: function() {
            v("#edit_pos_host_barcode").on("click", ".edit-order-item", this.edit_item).on("click", ".delete-order-item", this.delete_item).on("click", ".cancel-action", this.cancel_action).on("click", ".save-action", this.save_action).on("click", "tr.item", this.select_row).on("click", "tr.item :input, tr.item a", this.select_row_child).on("click", "button.add-line-item", this.add_item).on("click", "button.add-line-item-category", this.add_category_items).on("click", "button.bulk-add-variations", this.add_item_variations).on("click", "button.bulk-delete-items", this.bulk_delete_items).on("click", ".meta_removable button", this.remove_attributes), v(document.body).on("change", ".fields_to_print", this.fields_to_print).on("click", "#add_products", this.add_products).on("click", ".modal-close", this.modal_close).on("click", "#print_barcode", this.print_barcodes).append('<div id="printable_barcode"></div>')
        },
        print_barcodes: function() {
            if (!v("#edit_pos_host_barcode #order_line_items tr.item").length) return !1;
            var e = v("#label_type").val(),
                s = parseInt(v("#number_of_labels").val());
            switch ((isNaN(s) || s < 1) && (s = 1), v("#printable_barcode").html(""), v("#edit_pos_host_barcode #order_line_items tr").each(function(e, t) {
                    var a = parseInt(v(t).find("td.quantity .quantity").val()),
                        o = s;
                    !isNaN(a) && 1 < a && (o = a);
                    for (var r = 0; r < o; r++) v("#printable_barcode").append(v(t).find(".barcode_border").clone())
                }), e) {
                case "continuous_feed":
                    v("#printable_barcode").addClass("continuous_feed"), v("#printable_barcode").removeClass("jew_50_10").removeClass("con_4_2").removeClass("con_4_3").removeClass("a4").removeClass("letter").removeClass("per_sheet_80").removeClass("per_sheet_30").removeClass("a4_30").removeClass("a4_27");
                    break;
                case "a4":
                    v("#printable_barcode").addClass("a4"), v("#printable_barcode").removeClass("jew_50_10").removeClass("con_4_2").removeClass("con_4_3").removeClass("continuous_feed").removeClass("letter").removeClass("per_sheet_80").removeClass("per_sheet_30").removeClass("a4_30").removeClass("a4_27");
                    break;
                case "letter":
                    v("#printable_barcode").addClass("letter"), v("#printable_barcode").removeClass("jew_50_10").removeClass("con_4_2").removeClass("con_4_3").removeClass("continuous_feed").removeClass("a4").removeClass("per_sheet_80").removeClass("per_sheet_30").removeClass("a4_30").removeClass("a4_27");
                    break;
                case "per_sheet_30":
                    v("#printable_barcode").addClass("per_sheet_30"), v("#printable_barcode").removeClass("jew_50_10").removeClass("con_4_2").removeClass("con_4_3").removeClass("continuous_feed").removeClass("a4").removeClass("letter").removeClass("per_sheet_80").removeClass("a4_30").removeClass("a4_27");
                    break;
                case "per_sheet_80":
                    v("#printable_barcode").addClass("per_sheet_80"), v("#printable_barcode").removeClass("jew_50_10").removeClass("con_4_2").removeClass("con_4_3").removeClass("continuous_feed").removeClass("a4").removeClass("letter").removeClass("per_sheet_30").removeClass("a4_30").removeClass("a4_27");
                    break;
                case "a4_30":
                    v("#printable_barcode").addClass("a4_30"), v("#printable_barcode").removeClass("jew_50_10").removeClass("con_4_2").removeClass("con_4_3").removeClass("continuous_feed").removeClass("a4").removeClass("letter").removeClass("per_sheet_30").removeClass("per_sheet_80").removeClass("a4_27");
                    break;
                case "con_4_3":
                    v("#printable_barcode").addClass("con_4_3"), v("#printable_barcode").removeClass("jew_50_10").removeClass("con_4_2").removeClass("per_sheet_80").removeClass("continuous_feed").removeClass("a4").removeClass("letter").removeClass("per_sheet_30").removeClass("a4_30").removeClass("a4_27");
                    break;
                case "con_4_2":
                    v("#printable_barcode").addClass("con_4_2"), v("#printable_barcode").removeClass("jew_50_10").removeClass("con_4_3").removeClass("per_sheet_80").removeClass("continuous_feed").removeClass("a4").removeClass("letter").removeClass("per_sheet_30").removeClass("a4_30").removeClass("a4_27");
                    break;
                case "jew_50_10":
                    v("#printable_barcode").addClass("jew_50_10"), v("#printable_barcode").removeClass("con_4_2").removeClass("con_4_3").removeClass("per_sheet_80").removeClass("continuous_feed").removeClass("a4").removeClass("letter").removeClass("per_sheet_30").removeClass("a4_30").removeClass("a4_27");
                    break;
                case "a4_27":
                    v("#printable_barcode").addClass("a4_27"), v("#printable_barcode").removeClass("jew_50_10").removeClass("con_4_2").removeClass("con_4_3").removeClass("continuous_feed").removeClass("a4").removeClass("letter").removeClass("per_sheet_30").removeClass("per_sheet_80").removeClass("a4_30")
            }
            window.print()
        },
        fields_to_print: function() {
            var d = v("#field_barcode").is(":checked"),
                n = v("#field_sku").is(":checked"),
                c = v("#field_sku_label").is(":checked"),
                l = v("#field_name").is(":checked"),
                m = v("#field_price").is(":checked"),
                p = v("#field_meta_value").is(":checked"),
                b = v("#field_meta_title").is(":checked");
            v("#order_line_items .item").each(function(e, t) {
                var a, o, r, s, i = v(t).find(".barcode_border .barcode_text"),
                    _ = v(t).find(".barcode_border img").data("barcode_url");
                i.html(""), d ? v(t).find(".barcode_border img").show().attr("src", _ + "&font_size=0") : v(t).find(".barcode_border img").hide(), n && (a = v(t).find(".sku_text").text(), c && (a = '<span class="barcode_sku">SKU: ' + a + "</span>"), i.append(a).append("<br />")), l && (o = '<span class="barcode_name">' + (o = v(t).find(".wc-order-item-name").text()) + "</span>", i.append(o)), m && (r = '<span class="barcode_amount">' + (r = v(t).find(".product_price").text()) + "</span>", i.append(r)), p && (s = v(t).find(".display_meta tr"), v.each(s, function(e, t) {
                    var a = "";
                    b && (a = v(t).find("th").text() + "&nbsp;"), a = '<span class="meta_removable">' + (a += v(t).find("td").text()) + " <button></button></span>", i.append(a).append("<br />")
                }))
            })
        },
        modal_close: function() {
            return v("#add_item_id").select2("destroy"), v("#pos-host-barcode-modal-dialog").remove(), !1
        },
        init_tiptip: function() {
            v("#tiptip_holder").removeAttr("style"), v("#tiptip_arrow").removeAttr("style"), v(".tips").tipTip({
                attribute: "data-tip",
                fadeIn: 50,
                fadeOut: 50,
                delay: 200
            })
        },
        block: function() {
            v("#edit_pos_host_barcode").block({
                message: null,
                overlayCSS: {
                    background: "#fff",
                    opacity: .6
                }
            })
        },
        unblock: function() {
            v("#edit_pos_host_barcode").unblock()
        },
        edit_item: function() {
            var e = v(this).closest("tr");
            e.addClass("editing"), v(this).hide(), e.find("td.quantity .view").hide(), e.find("td.quantity .edit").show();
            var t = e.find("td.quantity .quantity").val();
            return e.find("td.quantity .quantity").data("qty", t), v(".wc-order-bulk-actions .barcode-edit-item").show(), !1
        },
        delete_item: function() {
            var e, t, a = parseInt(v(this).closest("tr").data("parentid"));
            return v(this).closest("tr").remove(), v("#tiptip_holder").hide(), v("#edit_pos_host_barcode #order_line_items tr").length ? (e = v('table.woocommerce_order_items tbody#order_line_items tr[data-parentid="' + a + '"]'), v('table.woocommerce_order_items tbody#order_line_items tr[data-prid="' + a + '"]').length || e.removeClass("variation_row")) : (t = v("#pos_host_barcode_no_products").html(), v("#edit_pos_host_barcode #order_line_items").html(t)), !1
        },
        cancel_action: function() {
            var e = v("#edit_pos_host_barcode tr.editing");
            return e.removeClass("editing"), e.find(".edit-order-item").removeAttr("style"), e.find("td.quantity .view").show(), e.find("td.quantity .edit").hide(), v(".wc-order-bulk-actions .barcode-edit-item").hide(), e.each(function(e, t) {
                var a = v(t).find("td.quantity .quantity").data("qty");
                v(t).find("td.quantity .quantity").val(a), v(t).find("td.quantity .view span").text(a)
            }), !1
        },
        save_action: function() {
            return v("#edit_pos_host_barcode tr.editing").each(function(e, t) {
                var a = v(t).find("td.quantity .quantity").val();
                v(t).find("td.quantity .quantity").data("qty", a)
            }), i.cancel_action(), !1
        },
        select_row: function() {
            var e = !1,
                e = v(this).is("tr") ? v(this) : v(this).closest("tr"),
                t = v(this).closest("table");
            e.is(".selected") ? e.removeClass("selected") : e.addClass("selected");
            var a, o = t.find("tr.selected");
            o.length ? (v(".bulk-delete-items").show(), a = !1, o.each(function() {
                v(this).is("tr.variable") && (a = !0)
            }), a ? v(".bulk-add-variations").show() : v(".bulk-add-variations").hide()) : v(".bulk-delete-items, .bulk-add-variations").hide()
        },
        select_row_child: function(e) {
            e.stopPropagation()
        },
        add_item: function() {
            var o, e = v("#pos_host_modal_barcode_add_products").html();
            return v("body").append(e), v("#order_line_items tr.item").length && (o = [], v("#order_line_items tr.item").each(function(e, t) {
                var a = parseInt(v(t).data("prid"));
                o.push(a)
            }), v("#add_item_id").data("exclude", o.join(","))), v(document.body).trigger("wc-enhanced-select-init"), !1
        },
        add_category_items: function() {
            var e = v("#pos_host_modal_barcode_add_products").html();
            return v("body").append(e), v("#add_item_id").data("action", "pos_host_json_search_categories").attr("data-placeholder", pos_host_barcode.select_placeholder_category).addClass("search_categories"), v(document.body).trigger("wc-enhanced-select-init"), !1
        },
        bulk_delete_items: function() {
            var e = v("table.woocommerce_order_items").find("tr.selected");
            return e.length && window.confirm(pos_host_barcode.remove_item_notice) && (e.find("a.delete-order-item").click(), v(".bulk-delete-items, .bulk-add-variations").hide()), !1
        },
        add_products: function() {
            var e, t;
            e = 3 <= pos_host_params.wc_version ? v("#add_item_id").val() : v("#add_item_id").val().split(","), v("#add_item_id").hasClass("search_categories") ? (i.block(), i.modal_close(), t = {
                action: "pos_host_get_products_by_categories",
                categories: e,
                security: pos_host_barcode.product_for_barcode_nonce
            }, v.post(pos_host_barcode.ajax_url, t, function(e) {
                var t = "object" !== _typeof(e) ? jQuery.parseJSON(e) : e;
                i.add_items(t)
            })) : i.add_items(e)
        },
        add_items: function(e) {
            var s;
            void 0 !== e && e && (s = e.length, i.block(), i.modal_close(), v.each(e, function(e, r) {
                var t;
                v("table.woocommerce_order_items tbody#order_line_items .item_" + r).length ? --s || (i.fields_to_print(), i.init_tiptip(), i.unblock()) : (t = {
                    action: "pos_host_add_product_for_barcode",
                    item_to_add: r,
                    security: pos_host_barcode.product_for_barcode_nonce
                }, v.post(pos_host_barcode.ajax_url, t, function(e) {
                    v("table.woocommerce_order_items tbody#order_line_items .no_products").remove();
                    var t = v(e),
                        a = parseInt(t.data("parentid")),
                        o = v('table.woocommerce_order_items tbody#order_line_items tr[data-parentid="' + a + '"]');
                    NaN != a && null != a && o.length ? (r == a ? o.first().before(e) : o.last().after(e), (o = v('table.woocommerce_order_items tbody#order_line_items tr[data-parentid="' + a + '"]')).removeClass("variation_row"), v('table.woocommerce_order_items tbody#order_line_items tr[data-prid="' + a + '"]').length && o.filter(".variation").addClass("variation_row")) : v("table.woocommerce_order_items tbody#order_line_items").append(e), --s || (i.fields_to_print(), i.init_tiptip(), i.unblock())
                }))
            }))
        },
        add_item_variations: function() {
            var e, t = v("table.woocommerce_order_items").find("tr.variable.selected"),
                o = [];
            t.length && (i.block(), t.each(function(e, t) {
                var a = parseInt(v(t).data("prid"));
                o.push(a)
            }), e = {
                action: "pos_host_get_product_variations_for_barcode",
                prid: o,
                security: pos_host_barcode.product_for_barcode_nonce
            }, v.post(pos_host_barcode.ajax_url, e, function(e) {
                var t = "object" !== _typeof(e) ? jQuery.parseJSON(e) : e;
                i.add_items(t)
            }))
        },
        remove_attributes: function() {
            var e = v(this).parent("span");
            e.next("br").remove(), e.remove()
        }
    };
    i.init()
});