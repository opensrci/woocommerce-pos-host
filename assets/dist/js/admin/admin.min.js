"use strict";
!function (a, s) {
    var i = s.pos_host_params;
    a(".form-table").on("click", "#enable_card", function (e) {
        e.preventDefault();
        var t = a(this).prev("input#pos_host_user_card_number");
        t.is(":disabled") && ("" === t.val() || s.confirm("Are you sure you want to change the card number?")) && t.removeAttr("disabled")
    }),
    a(".post-type-pos_host_register .submitdelete").on("click", function () {
        if (!s.confirm(i.i18n_confirm_delete_register))
            return !1
    }),
    a('.post-type-pos_host_register .bulkactions input[type="submit"]').on("click", function () {
        var e = a('.bulkactions select[name="action"]').val();
        if (("trash" === e || "delete" === e) && !s.confirm(i.i18n_confirm_delete_registers))
            return !1
    }),
    a("#pos_host_signature").change(function () {
        a(this).is(":checked") ? (a("#pos_host_signature_required").closest("tr").show(), a("#pos_host_signature_required_on").closest("tr").show()) : (a("#pos_host_signature_required").closest("tr").hide(), a("#pos_host_signature_required_on").closest("tr").hide())
    }).change(),
    a("input#pos_host_day_end_report").change(function () {
        a(this).is(":checked") ? a("#pos_host_day_end_emails").closest("tr").show() : a("#pos_host_day_end_emails").closest("tr").hide()
    }).change(),
    a("input#pos_host_enable_currency_rounding").change(function () {
        a(this).is(":checked") ? a("#pos_host_currency_rounding_value").closest("tr").show() : a("#pos_host_currency_rounding_value").closest("tr").hide()
    }).change();
    jQuery(document).ready(function () {
        jQuery(".reprint_receipts").attr("target", "_blank"),
        jQuery(".modal-close").on("click", function (e) {
            e.preventDefault()
        }),
        jQuery("#pos_host_user_card_number").on("keyup change", function (e) {
            var t = e.target.value;
            5 < t.length && jQuery.ajax({
                url: i.ajax_url,
                async: !0,
                type: "POST",
                data: {
                    action: "pos_host_check_user_card_uniqueness",
                    security: i.check_user_card_uniqueness_nonce,
                    code: t
                },
                success: function (e) {
                    jQuery("#pos_host_user_card_number").closest("td").find(".description").html(e.data),
                    !0 === e.success ? jQuery("#submit").attr("disabled", !1) : jQuery("#submit").attr("disabled", !0)
                }
            })
        })
    });
    a(".tips, .help_tip, .woocommerce-help-tip").tipTip({
        attribute: "data-tip",
        fadeIn: 50,
        fadeOut: 50,
        delay: 200
    }),
    0 < a('input[name="products_or_cat"]').length && (a('input[name="products_or_cat"]').change(function () {
            "category" == a('input[name="products_or_cat"]:checked').val() ? (a("#products_opt_wrap").hide(), a("#category_opt_wrap").show()) : (a("#products_opt_wrap").show(), a("#category_opt_wrap").hide())
        }).trigger("change"), a().select2 ? a(".category_chosen").css("width", "400px").select2() : a(".category_chosen").css("width", "400px").chosen()),
    a().select2 ? (jQuery("select#billing_country").select2(), jQuery("select#shipping_country").select2(), 0 < jQuery("select#billing_state").length && jQuery("select#billing_state").select2(), 0 < jQuery("select#shipping_state").length && jQuery("select#shipping_state").select2()) : (jQuery("select#billing_country").chosen(), jQuery("select#shipping_country").chosen(), 0 < jQuery("select#billing_state").length && jQuery("select#billing_state").chosen(), 0 < jQuery("select#shipping_state").length && jQuery("select#shipping_state").chosen()),
    0 < a("#pos_host_tax_calculation").length && (a(".disabled_select").attr("disabled", "disabled"), a("#pos_host_tax_calculation").change(function () {
            "disabled" === a(this).val() ? a("#pos_host_calculate_tax_based_on").parent().parent().hide() : a("#pos_host_calculate_tax_based_on").parent().parent().show()
        }).change()),
    jQuery("#pos-visibility .edit-pos-visibility").on("click", function (e) {
        e.preventDefault(),
        jQuery("#pos-visibility #pos-visibility-select").slideDown("fast")
    }),
    jQuery("#pos-visibility .save-post-visibility").on("click", function (e) {
        e.preventDefault();
        var t = jQuery('[name="_pos_visibility"]:checked');
        jQuery("#pos-visibility-display").text(t.data("label")),
        jQuery("#pos-visibility #pos-visibility-select").slideUp("fast")
    }),
    jQuery('.wc-enhanced-select-required-fields option[value="billing_first_name"],.wc-enhanced-select-required-fields option[value="billing_last_name"],.wc-enhanced-select-required-fields option[value="billing_email"]').attr({
        selected: "selected",
        disabled: "disabled"
    }),
    jQuery(".wc-enhanced-select-required-fields").select2().on("select2:unselecting", function (e) {
        if (e.params.args.data.disabled)
            return !1
    }),
    jQuery('#pos_host_search_includes.wc-enhanced-select option[value="title"]').attr({
        selected: "selected",
        disabled: "disabled"
    }),
    jQuery("#pos_host_search_includes.wc-enhanced-select").select2().on("select2:unselecting", function (e) {
        if (e.params.args.data.disabled)
            return !1
    }),
    a("#pos_custom_user_fields #pos_host_assigned_outlets").selectWoo({
        multiple: !0,
        width: "350px",
        placeholder: "No Outlet",
        allowClear: !0
    }),
    a(".wc-item-reorder-nav").find(".wc-move-up, .wc-move-down").on("click", function () {
        var e = a(this),
        t = e.closest("tr");
        e.focus();
        var s,
        i,
        n = e.is(".wc-move-up"),
        c = e.is(".wc-move-down");
        n ? (s = t.prev("tr")) && s.length && s.before(t) : !c || (i = t.next("tr")) && i.length && i.after(t),
        e.focus(),
        e.closest("table").trigger("updateMoveButtons")
    }).closest("table").on("updateMoveButtons", function () {
        console.log("moved");
        var e = a(this),
        t = a(this).find("tbody tr:last"),
        s = a(this).find("tbody tr:first");
        e.find(".wc-item-reorder-nav .wc-move-disabled").removeClass("wc-move-disabled").attr({
            tabindex: "0",
            "aria-hidden": "false"
        }),
        s.find(".wc-item-reorder-nav .wc-move-up").addClass("wc-move-disabled").attr({
            tabindex: "-1",
            "aria-hidden": "true"
        }),
        t.find(".wc-item-reorder-nav .wc-move-down").addClass("wc-move-disabled").attr({
            tabindex: "-1",
            "aria-hidden": "true"
        })
    }).closest("table").trigger("updateMoveButtons"),
    a("#pos_host_reset_settings").on("click", function (e) {
        s.confirm("This will reset entire POS settings. Please have a backup before doing this") || e.preventDefault()
    });
    var e,
    t = a("#pos_host_customer_create_required_fields");
    t.length && ((e = a('<button type="button" class="button reset_fields">Reset</button>')).on("click", function () {
            t.val(["billing_first_name", "billing_last_name", "billing_email", "billing_country", "billing_address_1", "billing_city", "billing_state", "billing_postcode", "billing_phone", "billing_email"]).change()
        }), t.parent("td").append(e)),
    a(".range_slider").on("input", function () {
        a(this).prev(".range_slider_value").html(a(this).val())
    });
    var n = a("#unit_of_measurement");
    a.each(n, function () {
        var e = a(this).parents("p");
        a(this).is(":checked") || e.nextAll("p").hide(),
        a(this).on("change", function () {
            a(this).is(":checked") ? e.nextAll("p").show() : e.nextAll("p").hide()
        })
    }),
    a("#paymentsense_eod_report").on("click", function () {
        var t = a("#wpcontent");
        t.find("#sale_report_overlay").remove(),
        t.block({
            message: null,
            opacity: .6
        }),
        a.ajax({
            url: s.ajaxurl,
            data: {
                register: a("#post_ID").val(),
                action: "pos_host_paymentsense_eod_report",
                security: i.paymentsense_eod_report_nonce,
                terminal_id: a("#paymentsense_terminal").val()
            },
            type: "POST",
            success: function (e) {
                e.data && t.append(a(e.data))
            },
            error: function (e) {
                e.responseJSON ? s.alert(e.responseJSON.data.message) : s.alert(e.statusText)
            },
            complete: function () {
                t.unblock()
            }
        })
    }),
    a("#wpcontent").on("click", ".close_popup, .back_to_sale", function () {
        a(".overlay_order_popup").hide()
    })
}
(jQuery, window, document);
